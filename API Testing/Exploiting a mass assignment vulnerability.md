# Exploiting a mass assignment vulnerability

**Scenario:**
To solve the lab, find and exploit a mass assignment vulnerability to buy a Lightweight l33t Leather Jacket. You can log in to your own account using the following credentials: wiener:peter.

Our first step here is going to be to add the **Lightweight l33t Leather Jacket** to our cart and place an order. In our HTTP history, we'll see the POST and GET request that have the path /api/checkout also have similar JSON structure. However, the chosen_discount parameter of the structure is included in the GET request but not the POST request.

# GET

<img width="3378" height="1832" alt="image" src="https://github.com/user-attachments/assets/c84051cd-0376-4242-93a5-029440b6df31" />

# POST


<img width="3378" height="1832" alt="image" src="https://github.com/user-attachments/assets/026abed3-ab74-4d1d-a7d3-3ee4583cd48c" />


I sent the POST request to Repeater so I could add the **chosen_discount** parameter and play around with it. I added a string of 5 in which I received the error: "Key order: Key chosen_discount: Key percentage: string is not a number".


<img width="3378" height="1832" alt="image" src="https://github.com/user-attachments/assets/bb9ebcd0-966f-4f92-8804-a37f2a36304c" />

I'll now keep the 5 as the value but remove the quotations to make this an integer.


<img width="3378" height="1832" alt="image" src="https://github.com/user-attachments/assets/f2d4415f-a587-44f8-a9b0-1ed8ba494347" />

We know that this accepts user input now so we can change the 5 to 100 to apply a full discount on the jacket and the lab is completed, fairly simple. 


<img width="3378" height="1776" alt="image" src="https://github.com/user-attachments/assets/f45e0360-e85e-405e-b6dc-4bce934afe0b" />

# Takeaway
The biggest flaw was that the application's backend was set up to accept data fields it didn't expect to receive. I noticed that the chosen_discount parameter was missing from the checkout request, but it showed up later. By putting that parameter back into the JSON structure of the POST request, I essentially forced the system to process it. I figured out it needed an integer and then I exploited the weakness by setting the discount to 100%. This applied a full discount to the jacket.
