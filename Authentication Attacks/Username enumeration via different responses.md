# Username Enumeration via Different responses

**Scenario:** This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password. To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.

# **Username Enumeration:**

The first step here will be to access the login page and input a random username and password to generate a HTTP request which we can then intercept using Proxy > Intercept. Find the POST request that was generated by your login attempt as this will allow us to modify it before ultimately reaching the server.

<img width="3356" height="1588" alt="image" src="https://github.com/user-attachments/assets/00898c14-23c5-4cb5-8814-3cdd9e83e141" />

Now that we've located the POST request, we'll want to send it to Intruder which is a tool to automate the process of enumerating lots of different usernames. Just something to note, we can see the username and password I entered when I initially attempted to login but failed.

<img width="3356" height="1596" alt="image" src="https://github.com/user-attachments/assets/596c61b2-0905-4113-9c54-3ea52c4d139f" />

After we've sent the request to intruder, we'll want to add a payload to value of the username or whatever we attempted to login with initially which for me is **admin** so this can be enumerated. Using the username list provided for the lab, we can copy and paste that into the payload configuration.

<img width="3356" height="1700" alt="image" src="https://github.com/user-attachments/assets/9c86eade-0acf-401b-b97e-8f8dedf7b695" />

After starting the attack, we'll want to keep an eye on the length for each username. Notice that every username will have the same length besides one. Keep note of this username that is different in length.

<img width="3356" height="1700" alt="image" src="https://github.com/user-attachments/assets/b28aa6a7-10dd-4da5-95a6-5a836d585c9e" />

Click on one of the usernames with a length of 3248, select Response, and Render. You'll see on the front-end the login attempt failed because of an incorrect username.

<img width="3356" height="1700" alt="image" src="https://github.com/user-attachments/assets/0a9f8f68-47be-40d2-9810-fdfd7241eb33" />
 
Now click on the username with the length of 3250, select Response, and Render. You'll see on the front-end the login attempt failed because of an incorrect password. This tells us **ag** is the correct username.

<img width="3356" height="1700" alt="image" src="https://github.com/user-attachments/assets/a563a429-c3b8-46e2-a738-194adf69ec42" />

<details>
  <summary>Username</summary>

   ```
   ag
   ```

</details>

# **Password Brute-Forcing:**

For brute-forcing the password, we'll want to follow the same process as enumerating the username, however, in your login attempt, enter the correct username which in this case is **ag**. Forward this request to Intruder, enter a payload for the password you used for the attempted login, and copy and past the list of passwords into the payload configuration. Once the attack is started, keep an eye out for the response code. We'll notice that one of the passwords returns 302 instead of 200 like all other passwords. This tells us that it successfully redirected us back to our account. 

<img width="3356" height="1486" alt="image" src="https://github.com/user-attachments/assets/c856d2d2-79cf-458a-a66b-11ecb77844ec" />

We can now enter our credentials.

<img width="3356" height="1448" alt="image" src="https://github.com/user-attachments/assets/64ec3828-ab41-45f5-9544-8b3fa982d76f" />

<details>
  <summary>Password</summary>

   ```
   biteme
   ```

</details>
