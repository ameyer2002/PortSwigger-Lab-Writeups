# Username Enumeration via Response Timing

**Scenario:**
This lab is vulnerable to username enumeration using its response times. To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.

# Username Enumeration:

The first step here will be to access the login page and input a random username and password to generate a HTTP request which we can then intercept using Proxy > Intercept. Find the POST request that was generated by your login attempt as this will allow us to modify it before ultimately reaching the server. We can then send this request to Repeater.

<img width="3356" height="1608" alt="image" src="https://github.com/user-attachments/assets/32fbe93a-3e8f-4091-a91b-7e1bcd62cbea" />

It is important to note that this lab implements an IP block after too many failed login attempts. What we can do to bypass this block is add a X-Forwarded-For (XFF) header to each HTTP request and use a random/different number each time the request is sent to the server. This header is a way to identify the original IP address of a client connecting to a web server so if we use a random number in the header for each request, it'll look like it's coming from different IPs.

We'll want to send this request over to Intruder. From here, we can add a payload to the X-Forwarded-For and the value of the username. From the dropdown list above, we'll want to select Pitchfork attack so we can run a simultaneous payload to each set position. Make sure to enter a very long password as well.

<img width="3404" height="1756" alt="image" src="https://github.com/user-attachments/assets/e666d1af-6a25-480b-b924-583c93df7f18" />

For the payload of the header, we'll choose the payload type as numbers. We can enter a number range based on how many usernames we are going to enumerate so our IP doesn't get blocked so 101.

<img width="3404" height="1756" alt="image" src="https://github.com/user-attachments/assets/24148bc8-ff4e-4df8-8c0f-2c6ad878536e" />

We can then switch over to the payload for the username and copy and paste the list of usernames into the payload configuration. Start the attack.

Once the enumeration has finished, look for anything that seems to be the odd-man out. We can see below the response received for **alterwind** is much longer than every other response. This could be the correct username.

<img width="3404" height="1756" alt="image" src="https://github.com/user-attachments/assets/3550ca2d-b812-417c-8c45-fbb0baf63fc8" />

<details>
  <summary>Username</summary>

   ```
   alterwind
   ```

</details>

I am now going to brute-force the password and copy and paste the list of given passwords into the payload configuration. For the payload configuration for the header, we'll want to use a range that was not used in the prior username enumeration. I'll use 105-206. Start the attack.

<img width="3404" height="1756" alt="image" src="https://github.com/user-attachments/assets/7bed3ac4-2174-40fc-b635-198fbb83890d" />

After looking at different responses, we can see **mustang** returned a 302 redirect whereas every other response returned a 200. This tells us **mustang** is the password. We can now login with the correct credentials

<details>
  <summary>Password</summary>

   ```
   mustang
   ```

</details>

<img width="3404" height="1510" alt="image" src="https://github.com/user-attachments/assets/9e5453b4-64b0-4f75-b474-3dd6236e898f" />

# Takeaway:
There were two lessons I learned here: first, that I could figure out a valid username, in this case, '**alterwind**' by watching for subtle differences in the server's behavior, specifically the extra time it took to respond (a "timing attack"), which indicates it's processing a correct username even if the password is wrong. Second, I learned how to easily get around the server's rate-limiting security by injecting a randomized X-Forwarded-For header in every request, making it look like the attacks were coming from over a hundred different IP addresses. Once I had the username, I brute-forced the password, successfully identifying '**mustang**' by watching for a successful 302 redirect. 
